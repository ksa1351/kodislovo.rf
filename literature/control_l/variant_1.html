<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Контрольная работа. Вариант 1 — кодислово.рф</title>
    <style>
        /* ===== БАЗОВЫЕ СТИЛИ И ПЕРЕМЕННЫЕ ===== */
        :root {
          --bg: #0b1020;
          --card: #121a33;
          --text: #e9ecff;
          --muted: #b8c0ff;
          --btn: #2b3a7a;
          --btn2: #1f2a57;
          --radius: 16px;
          --ok: #35d07f;
          --bad: #ff5b6e;
          --line: #27305a;
          --primary: #3a4aa0;
          --hover: #4a5bc0;
        }

        * {
          box-sizing: border-box;
          margin: 0;
          padding: 0;
        }

        html {
          scroll-behavior: smooth;
        }

        /* ===== ОСНОВНОЙ ФОН ===== */
        body {
          margin: 0;
          font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
          background: linear-gradient(180deg, #070a14, #0b1020 30%, #070a14);
          color: var(--text);
          line-height: 1.6;
          min-height: 100vh;
        }

        /* ===== ТИПОГРАФИЯ ===== */
        h1, h2, h3, h4, h5, h6 {
          font-weight: 700;
          line-height: 1.2;
          margin-bottom: 0.5em;
        }

        h1 { 
          font-size: 2.2rem; 
          background: linear-gradient(90deg, #e9ecff, #b8c0ff);
          -webkit-background-clip: text;
          background-clip: text;
          color: transparent;
        }
        
        h2 { font-size: 1.8rem; }
        h3 { font-size: 1.4rem; }
        h4 { font-size: 1.1rem; }

        p {
          margin-bottom: 1em;
        }

        /* ===== КОНТЕЙНЕРЫ ===== */
        .wrap {
          max-width: 1200px;
          margin: 0 auto;
          padding: 20px;
        }

        .card {
          background: rgba(18, 26, 51, 0.92);
          border: 1px solid var(--line);
          border-radius: var(--radius);
          padding: 24px;
          box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
          margin-bottom: 24px;
        }

        /* ===== КНОПКИ ===== */
        .btn {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
          border: 0;
          border-radius: var(--radius);
          padding: 12px 24px;
          cursor: pointer;
          color: var(--text);
          background: var(--btn);
          font-weight: 700;
          text-decoration: none;
          text-align: center;
          transition: all 0.3s ease;
          font-size: 16px;
          line-height: 1;
          border: 2px solid transparent;
          min-height: 44px;
        }

        .btn:hover {
          background: var(--hover);
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .btn:active {
          transform: translateY(0);
        }

        .btn.primary {
          background: var(--primary);
        }

        .btn.primary:hover {
          background: var(--hover);
          box-shadow: 0 8px 20px rgba(58, 74, 160, 0.4);
        }

        .btn.secondary {
          background: var(--btn2);
        }

        .btn.secondary:hover {
          background: var(--btn);
        }

        .btn.danger {
          background: rgba(255, 91, 110, 0.15);
          color: var(--bad);
          border: 1px solid rgba(255, 91, 110, 0.3);
        }

        .btn.danger:hover {
          background: rgba(255, 91, 110, 0.25);
        }

        .btn.full {
          width: 100%;
        }

        .btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: none !important;
        }

        /* ===== НАВИГАЦИЯ ===== */
        .nav-buttons {
          display: flex;
          gap: 12px;
          margin: 20px 0;
          flex-wrap: wrap;
        }

        .nav-buttons .btn {
          flex: 1;
          min-width: 140px;
        }

        /* ===== ИНФОРМАЦИОННЫЕ ГРУППЫ ===== */
        .info-group {
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
          margin: 20px 0;
          align-items: center;
          justify-content: space-between;
        }

        .student-info {
          background: rgba(43, 58, 122, 0.1);
          padding: 12px 18px;
          border-radius: 12px;
          border: 1px solid var(--line);
          font-size: 15px;
          display: flex;
          gap: 20px;
          flex-wrap: wrap;
        }

        .student-info label {
          display: flex;
          align-items: center;
          gap: 8px;
          color: var(--muted);
          font-weight: 500;
        }

        .student-info input {
          background: rgba(11, 18, 40, 0.8);
          border: 1px solid var(--line);
          border-radius: 8px;
          padding: 8px 12px;
          color: var(--text);
          font-size: 15px;
          min-width: 150px;
          transition: border-color 0.3s ease;
        }

        .student-info input:focus {
          border-color: var(--primary);
          outline: none;
        }

        .back-link {
          display: inline-flex;
          align-items: center;
          gap: 8px;
          color: var(--muted);
          text-decoration: none;
          font-size: 15px;
          margin-top: 10px;
          transition: color 0.3s ease;
        }

        .back-link:hover {
          color: var(--text);
        }

        /* ===== ОСНОВНОЙ КОНТЕЙНЕР ===== */
        .main-container {
          display: flex;
          gap: 30px;
          margin: 20px 0;
        }

        @media (max-width: 992px) {
          .main-container {
            flex-direction: column;
          }
        }

        /* ===== КОЛОНКА С ТЕКСТОМ ===== */
        .text-column {
          flex: 1;
          background: rgba(11, 18, 40, 0.8);
          border: 1px solid var(--line);
          border-radius: var(--radius);
          padding: 24px;
          overflow-y: auto;
          max-height: 600px;
        }

        .text-column h3 {
          color: var(--primary);
          margin-bottom: 20px;
          padding-bottom: 12px;
          border-bottom: 2px solid var(--line);
        }

        .poem-text {
          font-family: 'Georgia', 'Times New Roman', serif;
          font-size: 16px;
          line-height: 1.8;
          white-space: pre-line;
          color: var(--text);
        }

        .poem-text em {
          font-style: italic;
          color: var(--muted);
        }

        /* ===== КОЛОНКА С ЗАДАНИЯМИ ===== */
        .tasks-column {
          flex: 1;
        }

        .question-container {
          background: rgba(11, 18, 40, 0.8);
          border: 1px solid var(--line);
          border-radius: var(--radius);
          padding: 24px;
          margin-bottom: 20px;
          transition: border-color 0.3s ease;
        }

        .question-container:hover {
          border-color: var(--primary);
        }

        .question-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 16px;
          flex-wrap: wrap;
          gap: 12px;
        }

        .question-number {
          font-size: 18px;
          font-weight: 700;
          color: var(--primary);
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .question-number::before {
          content: "№";
          font-size: 14px;
          opacity: 0.7;
        }

        .question-type {
          font-size: 12px;
          color: var(--muted);
          padding: 6px 10px;
          background: rgba(184, 192, 255, 0.1);
          border-radius: 8px;
          text-transform: uppercase;
          letter-spacing: 0.5px;
        }

        .question-text {
          font-size: 16px;
          line-height: 1.6;
          margin-bottom: 20px;
          color: var(--text);
        }

        /* ===== ФОРМЫ ВВОДА ===== */
        input[type="text"],
        textarea {
          width: 100%;
          padding: 14px 16px;
          border-radius: 12px;
          border: 1px solid var(--line);
          background: rgba(11, 18, 40, 0.9);
          color: var(--text);
          outline: none;
          font-family: inherit;
          font-size: 16px;
          transition: border-color 0.3s ease;
          margin-top: 8px;
        }

        input[type="text"]:focus,
        textarea:focus {
          border-color: var(--primary);
        }

        textarea {
          min-height: 80px;
          resize: vertical;
        }

        /* ===== ТАБЛИЦЫ ===== */
        .task-table {
          width: 100%;
          border-collapse: collapse;
          margin: 15px 0;
        }

        .task-table td {
          padding: 12px;
          border: 1px solid var(--line);
          vertical-align: top;
        }

        .task-table td:first-child {
          color: var(--muted);
          font-size: 14px;
          width: 40%;
          background: rgba(11, 18, 40, 0.5);
        }

        .task-table input {
          width: 100%;
          background: transparent;
          border: none;
          color: var(--text);
          font-size: 15px;
          padding: 8px;
        }

        .task-table input:focus {
          outline: none;
          background: rgba(58, 74, 160, 0.1);
          border-radius: 6px;
        }

        /* ===== JSON ВЫВОД ===== */
        .json-output {
          background: rgba(11, 18, 40, 0.9);
          border: 1px solid var(--line);
          border-radius: var(--radius);
          padding: 20px;
          margin-top: 30px;
          font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
          font-size: 14px;
          white-space: pre-wrap;
          word-wrap: break-word;
          max-height: 300px;
          overflow-y: auto;
          color: var(--muted);
        }

        .json-output.highlight {
          border-color: var(--primary);
        }

        /* ===== ПРОГРЕСС БАР ===== */
        .progress-container {
          margin: 20px 0;
        }

        .progress-label {
          display: flex;
          justify-content: space-between;
          margin-bottom: 8px;
          font-size: 14px;
          color: var(--muted);
        }

        .progress-bar {
          height: 8px;
          background: var(--btn2);
          border-radius: 4px;
          overflow: hidden;
        }

        .progress-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--primary), var(--hover));
          border-radius: 4px;
          transition: width 0.3s ease;
          width: 0%;
        }

        /* ===== УТИЛИТЫ ===== */
        .text-center { text-align: center; }
        .text-muted { color: var(--muted); }
        .mt-1 { margin-top: 8px; }
        .mt-2 { margin-top: 16px; }
        .mt-3 { margin-top: 24px; }
        .mb-1 { margin-bottom: 8px; }
        .mb-2 { margin-bottom: 16px; }
        .mb-3 { margin-bottom: 24px; }
        .hidden { display: none !important; }

        /* ===== ВОДЯНОЙ ЗНАК ===== */
        .watermark-text-overlay {
          position: fixed;
          inset: 0;
          pointer-events: none;
          z-index: 9999;
          opacity: 0.1;
          background-image: 
            repeating-linear-gradient(
              -22deg,
              transparent,
              transparent 150px,
              rgba(255, 255, 255, 0.08) 150px,
              rgba(255, 255, 255, 0.08) 151px
            );
        }

        .watermark-text-overlay::before {
          content: "кодислово.рф кодислово.рф кодислово.рф";
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%) rotate(-45deg);
          font-size: 50px;
          font-weight: 900;
          color: rgba(255, 255, 255, 0.12);
          white-space: nowrap;
          letter-spacing: 25px;
          text-transform: uppercase;
        }

        /* ===== АДАПТИВНОСТЬ ===== */
        @media (max-width: 768px) {
          .wrap {
            padding: 16px;
          }
          
          .card {
            padding: 20px;
          }
          
          h1 { font-size: 1.8rem; }
          h2 { font-size: 1.5rem; }
          h3 { font-size: 1.2rem; }
          
          .btn {
            padding: 10px 20px;
            font-size: 15px;
          }
          
          .nav-buttons {
            flex-direction: column;
          }
          
          .nav-buttons .btn {
            width: 100%;
            min-width: auto;
          }
          
          .info-group {
            flex-direction: column;
            align-items: stretch;
            text-align: center;
          }
          
          .student-info {
            flex-direction: column;
            align-items: stretch;
            text-align: left;
          }
          
          .student-info input {
            width: 100%;
            min-width: auto;
          }
          
          .task-table td:first-child {
            width: 50%;
          }
          
          .watermark-text-overlay::before {
            font-size: 30px;
            letter-spacing: 15px;
          }
        }

        @media (max-width: 480px) {
          .wrap {
            padding: 12px;
          }
          
          .card {
            padding: 16px;
          }
          
          h1 { font-size: 1.6rem; }
          
          .btn {
            padding: 8px 16px;
            font-size: 14px;
            min-height: 40px;
          }
          
          .text-column,
          .question-container {
            padding: 16px;
          }
          
          .question-text {
            font-size: 15px;
          }
          
          .watermark-text-overlay::before {
            font-size: 20px;
            letter-spacing: 8px;
          }
        }

        /* Анимации */
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
          from { transform: translateX(-20px); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }

        .fade-in {
          animation: fadeIn 0.3s ease;
        }

        .slide-in {
          animation: slideIn 0.3s ease;
        }

        /* Специальные стили для контрольной */
        .control-header {
          text-align: center;
          margin-bottom: 30px;
        }

        .control-subject {
          color: var(--muted);
          font-size: 1.1rem;
          margin-top: 10px;
        }

        .completion-stats {
          display: flex;
          justify-content: space-between;
          background: rgba(43, 58, 122, 0.1);
          padding: 12px 20px;
          border-radius: 12px;
          margin: 20px 0;
          font-size: 14px;
        }

        .completion-stats span {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .completion-stats .completed {
          color: var(--ok);
        }

        .completion-stats .total {
          color: var(--muted);
        }
    </style>
</head>
<body>
    <div class="watermark-text-overlay"></div>
    
    <main class="wrap fade-in">
        <div class="card">
            <div class="control-header">
                <h1>Контрольная работа по литературе</h1>
                <p class="control-subject">Поэзия второй половины XIX века • Вариант 1</p>
            </div>

            <div class="info-group">
                <div class="student-info">
                    <label>
                        Фамилия, имя:
                        <input type="text" id="student-name" placeholder="Введите ФИО">
                    </label>
                    <label>
                        Класс:
                        <input type="text" id="student-class" placeholder="Например, 10А">
                    </label>
                </div>
                <a href="../index.html" class="back-link">
                    ← Вернуться к разделу Литература
                </a>
            </div>

            <div class="completion-stats">
                <span class="completed" id="completedCount">Выполнено: 0/9</span>
                <span class="total" id="totalTime">Примерное время: 45-60 мин</span>
            </div>

            <div class="progress-container">
                <div class="progress-label">
                    <span>Прогресс выполнения</span>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="main-container">
                <div class="text-column">
                    <h3>Текст для заданий 1-5</h3>
                    <div class="poem-text">
<em>Дед жил в особой горнице,
Семейки недолюбливал,
В свой угол не пускал;

А та сердилась, лаялась,

Его «клейменым, каторжным»

Честил родной сынок.

Савелий не рассердится.
Уйдет в свою светелочку,
Читает святцы, крестится,

Да вдруг и скажет весело:

«Клейменый, да не раб!..»

А крепко досадят ему —

Подшутит:
«Поглядите-тко,

К нам сваты!»
Незамужняя

Золовушка — к окну:
Ан вместо сватов — нищие!

Из оловянной пуговки

Дед вылепил двугривенный,
Подбросил на полу —

Попался свекор-батюшка!
Не пьяный из питейного —

Побитый приплелся!

Сидят, молчат за ужином:
У свекра бровь рассечена,

У деда, словно радуга,

Усмешка на лице.

«Как вы терпели, дедушка?»

— А потому терпели мы,

Что мы — богатыри.

В том богатырство русское.

Ты думаешь, Матренушка,

Мужик — не богатырь?

И жизнь его не ратная,

И смерть ему не писана

В бою — а богатырь!

Цепями руки кручены,

Железом ноги кованы,

Спина... леса дремучие

Прошли по ней — сломалися.

А грудь? Илья-пророк

По ней гремит — катается

На колеснице огненной...

Все терпит богатырь!

И гнется, да не ломится,

Не ломится, не валится...</em>
                    </div>
                </div>
                
                <div class="tasks-column">
                    <!-- Задание 1 -->
                    <div class="question-container slide-in" data-task="1">
                        <div class="question-header">
                            <div class="question-number">1</div>
                            <span class="question-type">Знание жанра</span>
                        </div>
                        <div class="question-text">
                            Как называется литературный жанр произведения Н.А. Некрасова «Кому на Руси жить хорошо»?
                        </div>
                        <input type="text" id="task1" placeholder="Введите ответ" class="task-input" data-task="1">
                    </div>

                    <!-- Задание 2 -->
                    <div class="question-container slide-in" data-task="2">
                        <div class="question-header">
                            <div class="question-number">2</div>
                            <span class="question-type">Анализ текста</span>
                        </div>
                        <div class="question-text">
                            Подберите примеры фольклорных слов и выражений из данного отрывка:
                        </div>
                        
                        <table class="task-table">
                            <tr>
                                <td>Просторечия и разговорные формы</td>
                                <td><input type="text" id="task2a" placeholder="Пример из текста" class="task-input" data-task="2"></td>
                            </tr>
                            <tr>
                                <td>Фольклорные эпитеты и устойчивые сочетания</td>
                                <td><input type="text" id="task2b" placeholder="Пример из текста" class="task-input" data-task="2"></td>
                            </tr>
                            <tr>
                                <td>Пословичные обороты</td>
                                <td><input type="text" id="task2c" placeholder="Пример из текста" class="task-input" data-task="2"></td>
                            </tr>
                            <tr>
                                <td>Народно‑поэтическая гипербола</td>
                                <td><input type="text" id="task2d" placeholder="Пример из текста" class="task-input" data-task="2"></td>
                            </tr>
                            <tr>
                                <td>Народные слова и бытовые детали</td>
                                <td><input type="text" id="task2e" placeholder="Пример из текста" class="task-input" data-task="2"></td>
                            </tr>
                        </table>
                    </div>

                    <!-- Задание 3 -->
                    <div class="question-container slide-in" data-task="3">
                        <div class="question-header">
                            <div class="question-number">3</div>
                            <span class="question-type">Анализ персонажа</span>
                        </div>
                        <div class="question-text">
                            Составьте формулу счастья богатыря Савелия из трёх компонентов. Что стоит за каждым компонентом?
                        </div>
                        <textarea id="task3" placeholder="Напишите ваш ответ здесь..." class="task-input" data-task="3" rows="4"></textarea>
                    </div>

                    <!-- Задание 4 -->
                    <div class="question-container slide-in" data-task="4">
                        <div class="question-header">
                            <div class="question-number">4</div>
                            <span class="question-type">Оценка поведения</span>
                        </div>
                        <div class="question-text">
                            Оцените, насколько прав Савелий, когда «подшучивает» над родными:
                        </div>
                        <div class="mb-2">
                            <strong>Аргумент «за»</strong> (что говорит в пользу его шуток):
                        </div>
                        <textarea id="task4a" placeholder="Напишите аргумент..." class="task-input" data-task="4" rows="3"></textarea>
                        <div class="mb-2 mt-2">
                            <strong>Аргумент «против»</strong> (что может свидетельствовать о злости шуток):
                        </div>
                        <textarea id="task4b" placeholder="Напишите аргумент..." class="task-input" data-task="4" rows="3"></textarea>
                    </div>

                    <!-- Задание 5 -->
                    <div class="question-container slide-in" data-task="5">
                        <div class="question-header">
                            <div class="question-number">5</div>
                            <span class="question-type">План сочинения</span>
                        </div>
                        <div class="question-text">
                            Составьте тезисный план сочинения на тему: «В чём заключается богатырство Савелия в понимании Некрасова: физическая сила или нравственная стойкость?»
                        </div>
                        
                        <div class="mb-2">
                            <strong>1. Вступление</strong>
                        </div>
                        <textarea id="task5a" placeholder="Напишите вступление..." class="task-input" data-task="5" rows="2"></textarea>
                        
                        <div class="mb-2 mt-2">
                            <strong>2.1. Главная идея (тезис)</strong>
                        </div>
                        <textarea id="task5b" placeholder="Сформулируйте тезис..." class="task-input" data-task="5" rows="2"></textarea>
                        
                        <div class="mb-2 mt-2">
                            <strong>2.2. Обоснование идеи</strong>
                        </div>
                        <textarea id="task5c" placeholder="Напишите обоснование..." class="task-input" data-task="5" rows="2"></textarea>
                        
                        <div class="mb-2 mt-2">
                            <strong>2.3. Иллюстрация аргументов</strong>
                        </div>
                        <textarea id="task5d" placeholder="Приведите примеры из текста..." class="task-input" data-task="5" rows="2"></textarea>
                        
                        <div class="mb-2 mt-2">
                            <strong>3. Заключение</strong>
                        </div>
                        <textarea id="task5e" placeholder="Напишите заключение..." class="task-input" data-task="5" rows="2"></textarea>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn secondary full" onclick="clearAll()">
                    Очистить все ответы
                </button>
                <button class="btn primary full" onclick="saveAnswers()">
                    Сохранить ответы в JSON
                </button>
            </div>

            <div class="json-output" id="jsonOutput">
                Здесь появится JSON с вашими ответами после сохранения...
            </div>
        </div>
    </main>

    <script>
        // Обновление прогресса
        function updateProgress() {
            const inputs = document.querySelectorAll('.task-input');
            let filled = 0;
            let total = 0;
            
            inputs.forEach(input => {
                total++;
                if (input.value.trim() !== '') {
                    filled++;
                }
            });
            
            const percent = Math.round((filled / total) * 100);
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('completedCount').textContent = `Выполнено: ${filled}/${total}`;
            
            // Подсветка выполненных заданий
            inputs.forEach(input => {
                const taskContainer = input.closest('.question-container');
                if (input.value.trim() !== '') {
                    taskContainer.style.borderColor = 'var(--ok)';
                    taskContainer.style.backgroundColor = 'rgba(53, 208, 127, 0.05)';
                } else {
                    taskContainer.style.borderColor = 'var(--line)';
                    taskContainer.style.backgroundColor = '';
                }
            });
        }
        
        // Сохранение ответов
        function saveAnswers() {
            const studentName = document.getElementById('student-name').value.trim();
            const studentClass = document.getElementById('student-class').value.trim();
            
            if (!studentName || !studentClass) {
                alert('Пожалуйста, заполните ваше ФИО и класс');
                return;
            }
            
            const answers = {
                variant: 1,
                subject: "Литература",
                theme: "Поэзия второй половины XIX века",
                student: {
                    name: studentName,
                    class: studentClass,
                    date: new Date().toLocaleDateString('ru-RU'),
                    time: new Date().toLocaleTimeString('ru-RU')
                },
                answers: {
                    task_1: document.getElementById('task1').value,
                    task_2: {
                        prostorechie: document.getElementById('task2a').value,
                        epitety: document.getElementById('task2b').value,
                        poslovicy: document.getElementById('task2c').value,
                        giperbola: document.getElementById('task2d').value,
                        bytovye_detali: document.getElementById('task2e').value
                    },
                    task_3: document.getElementById('task3').value,
                    task_4: {
                        argument_za: document.getElementById('task4a').value,
                        argument_protiv: document.getElementById('task4b').value
                    },
                    task_5: {
                        vstuplenie: document.getElementById('task5a').value,
                        glavnaya_idea: document.getElementById('task5b').value,
                        obosnovanie: document.getElementById('task5c').value,
                        illustraciya: document.getElementById('task5d').value,
                        zakluchenie: document.getElementById('task5e').value
                    }
                },
                stats: {
                    completed: document.querySelectorAll('.task-input[value!=""]').length,
                    total: document.querySelectorAll('.task-input').length,
                    completion_time: new Date().toISOString()
                }
            };
            
            // Показать JSON на странице
            const jsonOutput = document.getElementById('jsonOutput');
            jsonOutput.textContent = JSON.stringify(answers, null, 2);
            jsonOutput.classList.add('highlight');
            
            // Создать и скачать файл
            const filename = `Контрольная_${studentName.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.json`;
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(answers, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", filename);
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            
            // Сохранить в localStorage
            localStorage.setItem('literature_test_draft', JSON.stringify(answers));
            
            // Уведомление
            alert('Ответы сохранены! Файл скачан автоматически.');
        }
        
        // Очистка всех ответов
        function clearAll() {
            if (confirm('Вы уверены, что хотите очистить все ответы? Это действие нельзя отменить.')) {
                document.querySelectorAll('.task-input').forEach(input => {
                    input.value = '';
                });
                document.getElementById('jsonOutput').textContent = 'Здесь появится JSON с вашими ответами после сохранения...';
                document.getElementById('jsonOutput').classList.remove('highlight');
                updateProgress();
                localStorage.removeItem('literature_test_draft');
                alert('Все ответы очищены!');
            }
        }
        
        // Автосохранение при вводе
        let saveTimeout;
        document.querySelectorAll('.task-input').forEach(element => {
            element.addEventListener('input', () => {
                updateProgress();
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(saveDraft, 2000);
            });
        });
        
        // Сохранение черновика
        function saveDraft() {
            const draft = {
                name: document.getElementById('student-name').value,
                class: document.getElementById('student-class').value,
                tasks: {}
            };
            
            document.querySelectorAll('.task-input').forEach((input, index) => {
                draft.tasks[`task_${index + 1}`] = input.value;
            });
            
            localStorage.setItem('literature_test_draft', JSON.stringify(draft));
        }
        
        // Восстановление из localStorage при загрузке
        document.addEventListener('DOMContentLoaded', () => {
            const saved = localStorage.getItem('literature_test_draft');
            if (saved) {
                try {
                    const draft = JSON.parse(saved);
                    document.getElementById('student-name').value = draft.name || '';
                    document.getElementById('student-class').value = draft.class || '';
                    
                    if (draft.tasks) {
                        Object.keys(draft.tasks).forEach(key => {
                            const input = document.getElementById(key);
                            if (input) input.value = draft.tasks[key];
                        });
                    }
                    
                    updateProgress();
                    console.log('Черновик восстановлен из localStorage');
                } catch (e) {
                    console.error('Ошибка восстановления черновика:', e);
                }
            }
            
            // Инициализация прогресса
            updateProgress();
        });
    </script>
</body>
</html>
