<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Сброс контрольной</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../assets/css/ui.css">
</head>
<body>
<main class="wrap" style="padding:18px">
  <div class="card" style="max-width:820px;margin:0 auto">
    <h1 style="margin:0 0 10px">Сброс результатов контрольной</h1>
    <div class="sub">Сбросит прогресс и данные ученика <b>на этом устройстве</b> (в этом браузере).</div>

    <div style="margin-top:14px" class="sub">
      <b>Контрольная:</b> <code id="u"></code>
    </div>

    <div class="btnbar" style="margin-top:14px">
      <button id="doReset">Сбросить</button>
      <a href="./" style="text-decoration:none"><button class="secondary">← В раздел учителя</button></a>
    </div>

    <div id="msg" class="sub" style="margin-top:14px"></div>
  </div>
</main>

<script>
  // dataUrl должен совпадать с тем, что в student.html: "./variant26_cut.json"
  const dataUrl = new URLSearchParams(location.search).get("data") || "../russian/control/variant26_cut.json";
  // ключ такой же, как в control_core: "kontrol:" + dataUrl (ВАЖНО: должен быть 1-в-1)
  const STORAGE_KEY = "kontrol:" + dataUrl;
  const ID_KEY = STORAGE_KEY + ":identity";
  const TIMER_KEY = STORAGE_KEY + ":timer"; // если вы сохраняете таймер — на всякий

  document.getElementById("u").textContent = dataUrl;

  document.getElementById("doReset").onclick = () => {
    localStorage.removeItem(STORAGE_KEY);
    localStorage.removeItem(ID_KEY);
    localStorage.removeItem(TIMER_KEY);
    document.getElementById("msg").innerHTML =
      "✅ Сброшено. Теперь ученик может открыть контрольную заново на этом устройстве.";
  };
</script>
</body>
</html>
