<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Задание 1. Грамматическая основа</title>
<style>
body {font-family: Arial; margin: 20px; background:#f4f6f9;}
h1 {text-align:center;}
.task {background:white; padding:15px; margin-bottom:15px; border-radius:8px;}
.answers button {
    margin:5px;
    padding:8px 12px;
    border:none;
    border-radius:6px;
    background:#e0e6ef;
    cursor:pointer;
}
.answers button.active {
    background:#4c84ff;
    color:white;
}
#result {font-size:18px; font-weight:bold; margin-top:20px;}
.control-buttons {margin-top:20px;}
</style>
</head>
<body>

<h1>Задание 1. Грамматическая основа</h1>

<div id="tasks"></div>

<div class="control-buttons">
<button onclick="check()">Проверить</button>
<button onclick="download()">Скачать ответы (JSON)</button>
</div>

<div id="result"></div>

<script>
const correct = {
1:[1,3,4],
2:[1,3,5],
3:[1,4,5],
4:[1,4],
5:[2,3,4],
6:[1,2,3,5],
7:[1,2,4,5],
8:[1,2,3,5],
9:[1,2,3,5],
10:[3,4,5],
11:[1,4,5],
12:[3,4,5],
13:[1,2,4,5],
14:[1,3,4],
15:[1,4,5],
16:[1,3,5],
17:[1,2,4,5],
18:[1,2,3,5],
19:[2,3,5],
20:[1,4,5],
21:[1,2,4,5]
};

const tasksDiv = document.getElementById("tasks");
let answers = JSON.parse(localStorage.getItem("task1_answers")) || {};

for(let i=1;i<=21;i++){
    let div = document.createElement("div");
    div.className="task";
    div.innerHTML = `<b>Задание ${i}</b>
    <div class="answers" id="task${i}"></div>`;
    tasksDiv.appendChild(div);

    for(let j=1;j<=5;j++){
        let btn = document.createElement("button");
        btn.textContent=j;
        btn.onclick=()=>toggle(i,j,btn);
        if(answers[i]?.includes(j)) btn.classList.add("active");
        document.getElementById(`task${i}`).appendChild(btn);
    }
}

function toggle(task,variant,btn){
    if(!answers[task]) answers[task]=[];
    if(answers[task].includes(variant)){
        answers[task]=answers[task].filter(v=>v!==variant);
        btn.classList.remove("active");
    }else{
        answers[task].push(variant);
        btn.classList.add("active");
    }
    localStorage.setItem("task1_answers",JSON.stringify(answers));
}

function check(){
    let score=0;
    for(let i=1;i<=21;i++){
        let a=(answers[i]||[]).sort().join();
        let c=correct[i].sort().join();
        if(a===c) score++;
    }
    document.getElementById("result").innerHTML=
    `Результат: ${score} из 21`;
}

function download(){
    let data = JSON.stringify(answers,null,2);
    let blob = new Blob([data],{type:"application/json"});
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "task1_answers.json";
    a.click();
}
</script>

</body>
</html>